% to compute the summary statistics  for blowfly data
% mijung wrote on jan 26, 2015

function s = ss_for_blowflydata(dat)

%%%%%%%%%%%%%%%%%%
% this part was for testing my ss function to Ted's python code. 
% IGNORE::::::
%%%%%%%%%%%%%%%%%%
% dat =   [948,   942,   911,   858,   801,   676,   504,   397, ...
%     248,   146,  1801,  6235,  5974,  8921,  6610,  5973, ...
%     5673,  3875,  2361,  1352,  1226,   912,   521,   363, ...
%     229,   142,    82,   542,   939,  2431,  3687,  4543, ...
%     4535,  5441,  4412,  3022,  2656,  1967,  1295,   915, ...
%     551,   313,   167,    95,    93,    60,    68,  5259, ...
%     6673,  5441,  3987,  2952,  3648,  4222,  3889,  2295, ...
%     1509,   928,   739,   566,   383,   274,   192,   226, ...
%     519,  1224,  2236,  3818,  6208,  5996,  5789,  6652, ...
%     7939,  4868,  3952,  2712,  1734,  1224,   703,   508, ...
%     366,   279,   243,   343,   761,  1025,  1221,  1600, ...
%     2267,  3290,  3471,  3637,  3703,  4876,  5364,  4890, ...
%     3029,  1950,  1225,  1076,   905,   772,   628,   473, ...
%     539,   825,  1702,  2868,  4473,  5221,  6592,  6400, ...
%     4752,  3521,  2719,  1931,  1500,  1082,   849,   774, ...
%     864,  1306,  1624,  2224,  2423,  2959,  3547,  7237, ...
%     5218,  5311,  4273,  3270,  2281,  1549,  1091,   796, ...
%     610,   445,   894,  1454,  2262,  2363,  3847,  3876, ...
%     3935,  3479,  3415,  3861,  3571,  3113,  2319,  1630, ...
%     1297,   861,   761,   659,   701,   762,  1188,  1778, ...
%     2428,  3806,  4519,  5646,  4851,  5374,  4713,  7367, ...
%     7236,  5345,  3636,  2417,  1258,   766,   479,   402, ...
%     248,   254,   604,  1346];
%%%%%%%%%%%%%%%%%%

nstats = 10; 
N = length(dat);
s = zeros(nstats, 1); 

sorted = sort(dat);
sorted_dif = sort(diff(dat));

q14 = mean(sorted(1:N/4));
q24 = mean(sorted(N/4+1:N/2));
% q2 = mean(sorted(N/4+1:3*N/4));
q34 = mean( sorted(N/2+1:3*N/4)); 
 q44 = mean( sorted(3*N/4+1:N));
 
 s(1) = log(q14/1000.0+1e-12);
 s(2) = log(q24/1000.0+1e-12);
 s(3) = log(q34/1000.0+1e-12);
 s(4) = log(q44/1000.0+1e-12);
 
 
 q14 = mean( sorted_dif(1:N/4));
 q24 = mean( sorted_dif(N/4+1:N/2));
 q34 = mean( sorted_dif(N/2+1:3*N/4));
 q44 = mean( sorted_dif(3*N/4+1:end));
 
 s(5) = q14/1000.0;
 s(6) = q24/1000.0 ;
 s(7) = q34/1000.0;
 s(8) = q44/1000.0 ;
 
 ss = std(dat,1);
 
 if ss>0
     
     x = dat/ss;
     
%  [maxtab, mintab]=peakdet(v, delta, x)
      [mx,mn] = peakdet(x, 0.5 );
      s(9) = round(length(mx));
      [mx,mn] = peakdet(x, 1.5 );
      s(10) = round(length(mx));

 end
 
 
 
